{"ast":null,"code":"var _jsxFileName = \"/Users/edisoncardenas/Downloads/repo/outletify-client/outletify-client/src/pages/ItemDetailsPage.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useContext } from \"react\";\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport StripeCheckout from \"react-stripe-checkout\";\nimport { AuthContext } from \"../context/auth.context\";\nimport Swal from \"sweetalert2\";\nimport withReactContent from \"sweetalert2-react-content\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst API_URL = \"https://codebooks.fly.dev\";\n\nfunction ItemDetailsPage(props) {\n  _s();\n\n  var _user$cart;\n\n  const Navigate = useNavigate();\n  const {\n    isLoggedIn,\n    user,\n    logOutUser\n  } = useContext(AuthContext);\n  const [cart, setCart] = useState();\n  const [item, setItem] = useState();\n  const {\n    itemId\n  } = useParams();\n  const key = \"pk_test_51M9ZjvG6NeaDtKpVRFtUgmoFVxEMaTjHtPct35DcaB1DLIyvoEqXQ6vAvcgqKcp7cfjeIs5J0ZH94EhjCsSyWN7Z00xeCRkTs7\";\n\n  const getAllItemsinCart = () => {\n    const storedToken = localStorage.getItem(\"authToken\");\n    axios.get(`${API_URL}/auth/user/cart`, {\n      headers: {\n        Authorization: `Bearer ${storedToken}`\n      }\n    }).then(response => {\n      setCart(response.data.cart);\n    }).catch(error => console.log(error));\n  };\n\n  useEffect(() => {\n    getAllItemsinCart();\n  }, []);\n\n  const getItem = () => {\n    const storedToken = localStorage.getItem(\"authToken\");\n    axios.get(`${API_URL}/auth/items/${itemId}`, {\n      headers: {\n        Authorization: `Bearer ${storedToken}`\n      }\n    }).then(response => {\n      const oneItem = response.data;\n      console.log(oneItem);\n      setItem(oneItem);\n    }).catch(error => console.log(error));\n  };\n\n  useEffect(() => {\n    getItem();\n  }, []);\n  const MySwal = withReactContent(Swal);\n\n  const handleAddToCart = () => {\n    const requestBody = {\n      item\n    };\n    const storedToken = localStorage.getItem(\"authToken\");\n    axios.post(`${API_URL}/auth/order/${itemId}`, requestBody, {\n      headers: {\n        Authorization: `Bearer ${storedToken}`\n      }\n    }).then(response => {\n      getItem();\n    });\n  };\n\n  const handleSuccess = () => {\n    MySwal.fire({\n      icon: \"success\",\n      title: \"Payment was succesful\",\n      time: 1000\n    });\n  };\n\n  const payNow = async token => {\n    try {\n      const response = await axios({\n        url: \"https://codebooks.fly.dev/auth/payment\",\n        method: \"post\",\n        data: {\n          amount: item.price * 100,\n          token\n        }\n      });\n\n      if (response.status === 200) {\n        handleSuccess();\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const renderCartButtons = () => {\n    return isLoggedIn && /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: handleAddToCart,\n        children: \" Add to cart\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 97,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(StripeCheckout, {\n        stripeKey: key,\n        label: \"Pay Now\",\n        billingAddress: true,\n        shippingAddress: true,\n        amount: priceForStripe,\n        description: `your total is $${item === null || item === void 0 ? void 0 : item.price}`,\n        token: payNow\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 98,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true);\n  };\n\n  const priceForStripe = (item === null || item === void 0 ? void 0 : item.price) * 100;\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"item-detail-container\",\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"item-detail\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          children: [/*#__PURE__*/_jsxDEV(\"p\", {\n            children: item === null || item === void 0 ? void 0 : item.name\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 118,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"img\", {\n            src: item === null || item === void 0 ? void 0 : item.img,\n            alt: \"pic\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 121,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n            children: `$${item === null || item === void 0 ? void 0 : item.price}`\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 13\n          }, this), !isLoggedIn && /*#__PURE__*/_jsxDEV(Link, {\n            to: \"/login\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              children: \"Buy Now\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 126,\n              columnNumber: 17\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 15\n          }, this), user !== null && user !== void 0 && (_user$cart = user.cart) !== null && _user$cart !== void 0 && _user$cart.includes(item === null || item === void 0 ? void 0 : item._id) ? /*#__PURE__*/_jsxDEV(\"button\", {\n            className: \"disable\",\n            disabled: true,\n            children: \"In Cart\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 130,\n            columnNumber: 15\n          }, this) : renderCartButtons()]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"description-container\",\n          children: /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"description\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              children: \"Lorem Ipsum is simply dummy text of the printing and typesetting industry. Lorem Ipsum has been the industry's standard dummy text ever since the 1500s, when an unknown printer took a galley of type and scrambled it to make a type specimen book. It has survived not only five centuries, but also the leap into electronic typesetting, remaining essentially unchanged. It was popularised in the 1960s with the release of Letraset sheets\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 139,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 137,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 115,\n      columnNumber: 7\n    }, this)\n  }, void 0, false);\n}\n\n_s(ItemDetailsPage, \"3tVqMDBw95oGBxhzOn97+Faho50=\", false, function () {\n  return [useNavigate, useParams];\n});\n\n_c = ItemDetailsPage;\nexport default ItemDetailsPage;\n\nvar _c;\n\n$RefreshReg$(_c, \"ItemDetailsPage\");","map":{"version":3,"names":["useState","useEffect","useContext","useParams","Link","useNavigate","axios","StripeCheckout","AuthContext","Swal","withReactContent","API_URL","ItemDetailsPage","props","Navigate","isLoggedIn","user","logOutUser","cart","setCart","item","setItem","itemId","key","getAllItemsinCart","storedToken","localStorage","getItem","get","headers","Authorization","then","response","data","catch","error","console","log","oneItem","MySwal","handleAddToCart","requestBody","post","handleSuccess","fire","icon","title","time","payNow","token","url","method","amount","price","status","renderCartButtons","priceForStripe","name","img","includes","_id"],"sources":["/Users/edisoncardenas/Downloads/repo/outletify-client/outletify-client/src/pages/ItemDetailsPage.js"],"sourcesContent":["import { useState, useEffect, useContext } from \"react\";\nimport { useParams, Link, useNavigate } from \"react-router-dom\";\nimport axios from \"axios\";\nimport StripeCheckout from \"react-stripe-checkout\";\nimport { AuthContext } from \"../context/auth.context\";\nimport Swal from \"sweetalert2\";\nimport withReactContent from \"sweetalert2-react-content\";\n\nconst API_URL = \"https://codebooks.fly.dev\";\n\nfunction ItemDetailsPage(props) {\n  const Navigate = useNavigate();\n  const { isLoggedIn, user, logOutUser } = useContext(AuthContext);\n  const [cart, setCart] = useState();\n  const [item, setItem] = useState();\n  const { itemId } = useParams();\n  const key =\n    \"pk_test_51M9ZjvG6NeaDtKpVRFtUgmoFVxEMaTjHtPct35DcaB1DLIyvoEqXQ6vAvcgqKcp7cfjeIs5J0ZH94EhjCsSyWN7Z00xeCRkTs7\";\n\n  const getAllItemsinCart = () => {\n    const storedToken = localStorage.getItem(\"authToken\");\n    axios\n      .get(`${API_URL}/auth/user/cart`, {\n        headers: { Authorization: `Bearer ${storedToken}` },\n      })\n      .then((response) => {\n        setCart(response.data.cart);\n      })\n      .catch((error) => console.log(error));\n  };\n  useEffect(() => {\n    getAllItemsinCart();\n  }, []);\n\n  const getItem = () => {\n    const storedToken = localStorage.getItem(\"authToken\");\n    axios\n      .get(`${API_URL}/auth/items/${itemId}`, {\n        headers: { Authorization: `Bearer ${storedToken}` },\n      })\n      .then((response) => {\n        const oneItem = response.data;\n        console.log(oneItem);\n        setItem(oneItem);\n      })\n      .catch((error) => console.log(error));\n  };\n\n  useEffect(() => {\n    getItem();\n  }, []);\n\n  const MySwal = withReactContent(Swal);\n\n  const handleAddToCart = () => {\n    const requestBody = { item };\n    const storedToken = localStorage.getItem(\"authToken\");\n    axios\n      .post(`${API_URL}/auth/order/${itemId}`, requestBody, {\n        headers: { Authorization: `Bearer ${storedToken}` },\n      })\n      .then((response) => {\n        getItem();\n      });\n  };\n\n  const handleSuccess = () => {\n    MySwal.fire({\n      icon: \"success\",\n      title: \"Payment was succesful\",\n      time: 1000,\n    });\n  };\n\n  const payNow = async (token) => {\n    try {\n      const response = await axios({\n        url: \"https://codebooks.fly.dev/auth/payment\",\n        method: \"post\",\n        data: {\n          amount: item.price * 100,\n          token,\n        },\n      });\n      if (response.status === 200) {\n        handleSuccess();\n      }\n    } catch (error) {\n      console.log(error);\n    }\n  };\n\n  const renderCartButtons = () => {\n    return (\n      isLoggedIn && (\n        <>\n          <button onClick={handleAddToCart}> Add to cart</button>\n          <StripeCheckout\n            stripeKey={key}\n            label=\"Pay Now\"\n            billingAddress\n            shippingAddress\n            amount={priceForStripe}\n            description={`your total is $${item?.price}`}\n            token={payNow}\n          />\n        </>\n      )\n    );\n  };\n\n  const priceForStripe = item?.price * 100;\n  return (\n    <>\n      <div className=\"item-detail-container\">\n        <div className=\"item-detail\">\n          <div>\n            <p>{item?.name}</p>\n            <br></br>\n\n            <img src={item?.img} alt=\"pic\" />\n            <p>{`$${item?.price}`}</p>\n            <br></br>\n            {!isLoggedIn && (\n              <Link to=\"/login\">\n                <button>Buy Now</button>\n              </Link>\n            )}\n            {user?.cart?.includes(item?._id) ? (\n              <button className=\"disable\" disabled>\n                In Cart\n              </button>\n            ) : (\n              renderCartButtons()\n            )}\n          </div>\n          <div className=\"description-container\">\n            <div className=\"description\">\n              <p>\n                Lorem Ipsum is simply dummy text of the printing and typesetting\n                industry. Lorem Ipsum has been the industry's standard dummy\n                text ever since the 1500s, when an unknown printer took a galley\n                of type and scrambled it to make a type specimen book. It has\n                survived not only five centuries, but also the leap into\n                electronic typesetting, remaining essentially unchanged. It was\n                popularised in the 1960s with the release of Letraset sheets\n              </p>\n            </div>\n          </div>\n        </div>\n      </div>\n    </>\n  );\n}\n\nexport default ItemDetailsPage;\n"],"mappings":";;;AAAA,SAASA,QAAT,EAAmBC,SAAnB,EAA8BC,UAA9B,QAAgD,OAAhD;AACA,SAASC,SAAT,EAAoBC,IAApB,EAA0BC,WAA1B,QAA6C,kBAA7C;AACA,OAAOC,KAAP,MAAkB,OAAlB;AACA,OAAOC,cAAP,MAA2B,uBAA3B;AACA,SAASC,WAAT,QAA4B,yBAA5B;AACA,OAAOC,IAAP,MAAiB,aAAjB;AACA,OAAOC,gBAAP,MAA6B,2BAA7B;;;AAEA,MAAMC,OAAO,GAAG,2BAAhB;;AAEA,SAASC,eAAT,CAAyBC,KAAzB,EAAgC;EAAA;;EAAA;;EAC9B,MAAMC,QAAQ,GAAGT,WAAW,EAA5B;EACA,MAAM;IAAEU,UAAF;IAAcC,IAAd;IAAoBC;EAApB,IAAmCf,UAAU,CAACM,WAAD,CAAnD;EACA,MAAM,CAACU,IAAD,EAAOC,OAAP,IAAkBnB,QAAQ,EAAhC;EACA,MAAM,CAACoB,IAAD,EAAOC,OAAP,IAAkBrB,QAAQ,EAAhC;EACA,MAAM;IAAEsB;EAAF,IAAanB,SAAS,EAA5B;EACA,MAAMoB,GAAG,GACP,6GADF;;EAGA,MAAMC,iBAAiB,GAAG,MAAM;IAC9B,MAAMC,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAApB;IACArB,KAAK,CACFsB,GADH,CACQ,GAAEjB,OAAQ,iBADlB,EACoC;MAChCkB,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASL,WAAY;MAAvC;IADuB,CADpC,EAIGM,IAJH,CAISC,QAAD,IAAc;MAClBb,OAAO,CAACa,QAAQ,CAACC,IAAT,CAAcf,IAAf,CAAP;IACD,CANH,EAOGgB,KAPH,CAOUC,KAAD,IAAWC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CAPpB;EAQD,CAVD;;EAWAlC,SAAS,CAAC,MAAM;IACduB,iBAAiB;EAClB,CAFQ,EAEN,EAFM,CAAT;;EAIA,MAAMG,OAAO,GAAG,MAAM;IACpB,MAAMF,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAApB;IACArB,KAAK,CACFsB,GADH,CACQ,GAAEjB,OAAQ,eAAcW,MAAO,EADvC,EAC0C;MACtCO,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASL,WAAY;MAAvC;IAD6B,CAD1C,EAIGM,IAJH,CAISC,QAAD,IAAc;MAClB,MAAMM,OAAO,GAAGN,QAAQ,CAACC,IAAzB;MACAG,OAAO,CAACC,GAAR,CAAYC,OAAZ;MACAjB,OAAO,CAACiB,OAAD,CAAP;IACD,CARH,EASGJ,KATH,CASUC,KAAD,IAAWC,OAAO,CAACC,GAAR,CAAYF,KAAZ,CATpB;EAUD,CAZD;;EAcAlC,SAAS,CAAC,MAAM;IACd0B,OAAO;EACR,CAFQ,EAEN,EAFM,CAAT;EAIA,MAAMY,MAAM,GAAG7B,gBAAgB,CAACD,IAAD,CAA/B;;EAEA,MAAM+B,eAAe,GAAG,MAAM;IAC5B,MAAMC,WAAW,GAAG;MAAErB;IAAF,CAApB;IACA,MAAMK,WAAW,GAAGC,YAAY,CAACC,OAAb,CAAqB,WAArB,CAApB;IACArB,KAAK,CACFoC,IADH,CACS,GAAE/B,OAAQ,eAAcW,MAAO,EADxC,EAC2CmB,WAD3C,EACwD;MACpDZ,OAAO,EAAE;QAAEC,aAAa,EAAG,UAASL,WAAY;MAAvC;IAD2C,CADxD,EAIGM,IAJH,CAISC,QAAD,IAAc;MAClBL,OAAO;IACR,CANH;EAOD,CAVD;;EAYA,MAAMgB,aAAa,GAAG,MAAM;IAC1BJ,MAAM,CAACK,IAAP,CAAY;MACVC,IAAI,EAAE,SADI;MAEVC,KAAK,EAAE,uBAFG;MAGVC,IAAI,EAAE;IAHI,CAAZ;EAKD,CAND;;EAQA,MAAMC,MAAM,GAAG,MAAOC,KAAP,IAAiB;IAC9B,IAAI;MACF,MAAMjB,QAAQ,GAAG,MAAM1B,KAAK,CAAC;QAC3B4C,GAAG,EAAE,wCADsB;QAE3BC,MAAM,EAAE,MAFmB;QAG3BlB,IAAI,EAAE;UACJmB,MAAM,EAAEhC,IAAI,CAACiC,KAAL,GAAa,GADjB;UAEJJ;QAFI;MAHqB,CAAD,CAA5B;;MAQA,IAAIjB,QAAQ,CAACsB,MAAT,KAAoB,GAAxB,EAA6B;QAC3BX,aAAa;MACd;IACF,CAZD,CAYE,OAAOR,KAAP,EAAc;MACdC,OAAO,CAACC,GAAR,CAAYF,KAAZ;IACD;EACF,CAhBD;;EAkBA,MAAMoB,iBAAiB,GAAG,MAAM;IAC9B,OACExC,UAAU,iBACR;MAAA,wBACE;QAAQ,OAAO,EAAEyB,eAAjB;QAAA;MAAA;QAAA;QAAA;QAAA;MAAA,QADF,eAEE,QAAC,cAAD;QACE,SAAS,EAAEjB,GADb;QAEE,KAAK,EAAC,SAFR;QAGE,cAAc,MAHhB;QAIE,eAAe,MAJjB;QAKE,MAAM,EAAEiC,cALV;QAME,WAAW,EAAG,kBAAiBpC,IAAlB,aAAkBA,IAAlB,uBAAkBA,IAAI,CAAEiC,KAAM,EAN7C;QAOE,KAAK,EAAEL;MAPT;QAAA;QAAA;QAAA;MAAA,QAFF;IAAA,gBAFJ;EAgBD,CAjBD;;EAmBA,MAAMQ,cAAc,GAAG,CAAApC,IAAI,SAAJ,IAAAA,IAAI,WAAJ,YAAAA,IAAI,CAAEiC,KAAN,IAAc,GAArC;EACA,oBACE;IAAA,uBACE;MAAK,SAAS,EAAC,uBAAf;MAAA,uBACE;QAAK,SAAS,EAAC,aAAf;QAAA,wBACE;UAAA,wBACE;YAAA,UAAIjC,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAEqC;UAAV;YAAA;YAAA;YAAA;UAAA,QADF,eAEE;YAAA;YAAA;YAAA;UAAA,QAFF,eAIE;YAAK,GAAG,EAAErC,IAAF,aAAEA,IAAF,uBAAEA,IAAI,CAAEsC,GAAhB;YAAqB,GAAG,EAAC;UAAzB;YAAA;YAAA;YAAA;UAAA,QAJF,eAKE;YAAA,UAAK,IAAGtC,IAAJ,aAAIA,IAAJ,uBAAIA,IAAI,CAAEiC,KAAM;UAApB;YAAA;YAAA;YAAA;UAAA,QALF,eAME;YAAA;YAAA;YAAA;UAAA,QANF,EAOG,CAACtC,UAAD,iBACC,QAAC,IAAD;YAAM,EAAE,EAAC,QAAT;YAAA,uBACE;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA;UADF;YAAA;YAAA;YAAA;UAAA,QARJ,EAYGC,IAAI,SAAJ,IAAAA,IAAI,WAAJ,kBAAAA,IAAI,CAAEE,IAAN,kDAAYyC,QAAZ,CAAqBvC,IAArB,aAAqBA,IAArB,uBAAqBA,IAAI,CAAEwC,GAA3B,iBACC;YAAQ,SAAS,EAAC,SAAlB;YAA4B,QAAQ,MAApC;YAAA;UAAA;YAAA;YAAA;YAAA;UAAA,QADD,GAKCL,iBAAiB,EAjBrB;QAAA;UAAA;UAAA;UAAA;QAAA,QADF,eAqBE;UAAK,SAAS,EAAC,uBAAf;UAAA,uBACE;YAAK,SAAS,EAAC,aAAf;YAAA,uBACE;cAAA;YAAA;cAAA;cAAA;cAAA;YAAA;UADF;YAAA;YAAA;YAAA;UAAA;QADF;UAAA;UAAA;UAAA;QAAA,QArBF;MAAA;QAAA;QAAA;QAAA;MAAA;IADF;MAAA;MAAA;MAAA;IAAA;EADF,iBADF;AAyCD;;GA/IQ3C,e;UACUP,W,EAIEF,S;;;KALZS,e;AAiJT,eAAeA,eAAf"},"metadata":{},"sourceType":"module"}